<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>--pool4</title>
	<link href="../css/style.css" rel="stylesheet" type="text/css" media="screen" />
	<link href="../css/print.css" rel="stylesheet" type="text/css" media="print" />
</head>

<body>
	<div id="page">
		<div id="contentwrapper">
			<div id="sidebar_navigation" class="sidebar">
				<div class="left_sidebar_menu">
					<div class="left_sidebar_menu_button">
						<a href="index.html">Home</a>
					</div>
					<div class="left_sidebar_menu_selected">
						<a href="documentation.html">Documentation</a>
					</div>
					<div class="left_sidebar_menu_button">
						<a href="download.html">Download</a>
					</div>
					<div class="left_sidebar_menu_button">
						<a href="faq.html">FAQ</a>
					</div>
					<div class="left_sidebar_menu_button">
						<a href="https://github.com/NICMx/NAT64/issues" target="_blank">
							Report a Bug
						</a>
					</div>
					<div class="left_sidebar_menu_button">
						<a href="about.html">About</a>
					</div>
					<div class="left_sidebar_menu_button">
						<a href="contact.html">Contact</a>
					</div>
				</div>
			</div>
			<div id="content">
				<div class="worklogo">
					<a href="index.html"><img src="../images/jool.png" alt="logo-jool" /></a>
				</div>
				<div class="workarea">
					<div class="content_text">

<p><a href="documentation.html">Documentation</a> &gt; <a href="documentation.html#userspace-application">Userspace Application</a> &gt; <a href="usr-flags.html">Flags</a> &gt; --pool4</p>

<h1 id="pool4">--pool4</h1>

<h2 id="index">Index</h2>

<ol>
  <li><a href="#description">Description</a></li>
  <li><a href="#syntax">Syntax</a></li>
  <li><a href="#arguments">Arguments</a></li>
  <li><a href="#examples">Examples</a></li>
  <li><a href="#notes">Notes</a></li>
</ol>

<h2 id="description">Description</h2>

<p>Interacts with NAT64 Jool’s <a href="pool4.html">IPv4 transport address pool</a>.</p>

<p>The IPv4 pool is the subset of the node’s transport addresses which should be used to mask connections sourced from IPv6 nodes.</p>

<h2 id="syntax">Syntax</h2>

<pre><code>jool --pool4 [--display] [--csv]
jool --pool4 --count
jool --pool4 --add [--mark &lt;mark&gt;] [--tcp] [--udp] [--icmp] &lt;IPv4 prefix&gt; [&lt;port range&gt;] [--force]
jool --pool4 --remove [--mark &lt;mark&gt;] [--tcp] [--udp] [--icmp] &lt;IPv4 prefix&gt; [&lt;port range&gt;] [--quick]
jool --pool4 --flush [--quick]
</code></pre>

<h2 id="arguments">Arguments</h2>

<p>Operations:</p>

<ul>
  <li><code>--display</code>: The pool’s records are printed in standard output. This is the default operation.</li>
  <li><code>--count</code>: Prints the number of tables, samples and transport addresses in standard output.</li>
  <li><code>--add</code>: Uploads entries to the pool.</li>
  <li><code>--remove</code>: Deletes entries from the pool.</li>
  <li><code>--flush</code>: Removes all entries from the pool.</li>
</ul>

<p>Others:</p>

<table>
  <tbody>
    <tr>
      <td>Name</td>
      <td>Default</td>
      <td>Description</td>
    </tr>
    <tr>
      <td><code>--csv</code></td>
      <td>(absent)</td>
      <td>If present, print the table in CSV format.</td>
    </tr>
    <tr>
      <td><a href="https://github.com/NICMx/NAT64/issues/115"><code>--mark</code></a></td>
      <td>0</td>
      <td>Packets carrying mark <em>n</em> will only be translated using pool4 records with mark <em>n</em>.</td>
    </tr>
    <tr>
      <td><code>--tcp</code></td>
      <td>*</td>
      <td>If present, the record being added or removed represents TCP transport addresses.</td>
    </tr>
    <tr>
      <td><code>--udp</code></td>
      <td>*</td>
      <td>If present, the record being added or removed represents UDP transport addresses.</td>
    </tr>
    <tr>
      <td><code>--icmp</code></td>
      <td>*</td>
      <td>If present, the record being added or removed represents “ICMP transport addresses” (Addresses and ICMP identifiers, not ports).</td>
    </tr>
    <tr>
      <td><code>&lt;IPv4 prefix&gt;</code></td>
      <td>-</td>
      <td>Group of addresses you’re adding or removing to/from the pool. The length defaults to 32, so you typically add and remove addresses instead of prefixes.</td>
    </tr>
    <tr>
      <td><code>&lt;port range&gt;</code></td>
      <td>60001-65535</td>
      <td>Subset layer 4 identifiers (or ICMP ids) from the addresses which should be reserved for translation.</td>
    </tr>
    <tr>
      <td><code>--force</code></td>
      <td>(absent)</td>
      <td>If present, add the elements to the pool even if they’re too many.</td>
    </tr>
    <tr>
      <td><a href="usr-flags-quick.html"><code>--quick</code></a></td>
      <td>(absent)</td>
      <td>If present, do not cascade removal to BIB entries.</td>
    </tr>
  </tbody>
</table>

<p>* <code>--tcp</code>, <code>--udp</code> and <code>--icmp</code> are not mutually exclusive. If neither of them are present, the records are added or removed to/from all three protocols.</p>

<h2 id="examples">Examples</h2>

<p>Display the current addreses:</p>

<pre><code>$ jool --pool4 --display 
  (empty)
</code></pre>

<p>Add several entries:</p>

<pre><code># jool --pool4 --add 192.0.2.1
$ jool --pool4 --display
0	ICMP	192.0.2.1	60001-65535
0	UDP	192.0.2.1	60001-65535
0	TCP	192.0.2.1	60001-65535
  (Fetched 3 entries.)
# jool --pool4 --add          --tcp 192.0.2.2 7000-7999
# jool --pool4 --add --mark 1 --tcp 192.0.2.2 8000-8999
# jool --pool4 --add          --tcp 192.0.2.4/31
$ jool --pool4 --display
0	ICMP	192.0.2.1	60001-65535
0	UDP	192.0.2.1	60001-65535
0	TCP	192.0.2.1	60001-65535
0	TCP	192.0.2.2	7000-7999
0	TCP	192.0.2.4	60001-65535
0	TCP	192.0.2.5	60001-65535
1	TCP	192.0.2.2	8000-8999
  (Fetched 7 entries.)
</code></pre>

<p>Remove some entries:</p>

<pre><code># jool --pool4 --remove --mark 0 192.0.2.0/24 0-65535
$ jool --pool4 --display
1	TCP	192.0.2.2	8000-8999
  (Fetched 1 entries.)
</code></pre>

<p>Clear the table:</p>

<pre><code># jool --pool4 --flush
$ jool --pool4 --display
  (empty)
</code></pre>

<h2 id="notes">Notes</h2>

<p>If something within your NAT64 machine binds itself to one of the ports reserved by pool4, Jool will interfere with its packets. Therefore, it is in your best interests that pool4 doesn’t collide with other port ranges.</p>

<p>You already know the ports owned by any servers parked in your NAT64, if any. The other one you need to keep in mind is the <a href="https://en.wikipedia.org/wiki/Ephemeral_port">ephemeral range</a>:</p>

<pre><code>$ sysctl net.ipv4.ip_local_port_range 
net.ipv4.ip_local_port_range = 32768	61000
</code></pre>

<p>If you want to assign more ports to Jool, you have to substract them from elsewhere. The ephemeral range is a good candidate:</p>

<pre><code>$ jool --pool4 --display
0	192.0.2.1	60001-65535
  (Fetched 1 entries.)
# sysctl -w net.ipv4.ip_local_port_range="32768 40000"
# jool --pool4 --add 192.0.2.1 40001-60000
$ sysctl net.ipv4.ip_local_port_range 
net.ipv4.ip_local_port_range = 32768	40000
$ jool --pool4 --display
0	192.0.2.1	40001-65535
  (Fetched 1 entries.)
</code></pre>



					</div>
				</div>
			</div>
			<div id="language_selector">
				
					<span class="selected">en</span>
				
				|
				
					<a href="../es/usr-flags-pool4.html">es</a>
				
			</div>
			<div style="clear: both;">&nbsp;</div>
		</div>
	</div>

	<div id="footer">
		<div class="logo-tec"><a href="http://www.itesm.mx"><img src="../images/logo-tec.png" alt="logo-tec" /></a></div>
		<div class="logo-nic"><a href="http://www.nicmexico.mx/"><img src="../images/logo-nic.png" alt="logo-nic" /></a></div>
		<p class="legal">&copy;Jool 2015</p>
	</div>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-44741331-2', 'jool.mx');
	  ga('send', 'pageview');

	</script>
</body>
</html>
